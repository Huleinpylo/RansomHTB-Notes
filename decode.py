import os
import binascii

#file_name = "D:\\Users\\simon\\Downloads\\ransom\\aaa.txt"
file_name = "D:\\Users\\simon\\Downloads\\ransom\\login.xlsx.enc"
with open(file_name, 'rb') as f:
    content = f.read()
    f.close()
#content.encode('utf-8')
filehex=binascii.hexlify(content)
print(filehex)
print (content)

size=os.path.getsize(file_name)
print (size)
c=[
0x53,0x55,0x50,0x45,0x52,0x53,0x45,0x43, 
0x55,0x52,0x45,0x53,0x55,0x50,0x45,0x52, 
0x53,0x45,0x43,0x55,0x52,0x45,0x53,0x55, 
0x50,0x45,0x52,0x53,0x45,0x43,0x55,0x52, 
0x45,0x53,0x55,0x50,0x45,0x52,0x53,0x45, 
0x43,0x55,0x52,0x45,0x53,0x55,0x50,0x45, 
0x52,0x53,0x45,0x43,0x55,0x52,0x45,0x53, 
0x55,0x50,0x45,0x52,0x53,0x45,0x43,0x55, 
0x52,0x45,0x53,0x55,0x50,0x45,0x52,0x53,
0x45,0x43,0x55,0x52,0x45,0x53,0x55,0x50, 
0x45,0x52,0x53,0x45,0x43,0x55,0x52,0x45 
]
d=[]
e=[]
stringvar=""
for i_i in range(size-1) :
    d.append(hex(((content[i_i] - c[i_i%88] +256  )%256)))
    e.append(int(d[i_i],16))
    stringvar+=chr(e[i_i])
var =(''.join(d))
var2=var.replace("0x","")
print(d)
#print (var2)
#print (stringvar)
encoded_string = stringvar. encode()
byte_array = bytearray(encoded_string)
text_file = "D:\\Users\\simon\\Downloads\\ransom\\login.xlsx"
with open(text_file, 'wb') as f:
    f.write(byte_array)
    f.close()
